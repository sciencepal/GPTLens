[
    {
        "function_name": "withdrawAltcoinTokens",
        "code": "function withdrawAltcoinTokens(address _tokenContract) onlyOwner public returns (bool) { AltcoinToken token = AltcoinToken(_tokenContract); uint256 amount = token.balanceOf(address(this)); return token.transfer(owner, amount); }",
        "vulnerability": "Unsafe external call allowing withdrawal of arbitrary token",
        "reason": "This function allows the owner to withdraw any ERC20 tokens held by the contract. If a malicious owner gains control or abuses this function, they can drain all ERC20 tokens sent mistakenly or intentionally by participants to this contract. This can be exploited by a malicious or compromised owner to steal valuable tokens from the contract, causing significant financial loss to token holders or users who mistakenly send tokens to this address.",
        "file_name": "2018-18425.sol",
        "label": "Token Devalue",
        "description": "The doAirdrop function of a smart contract implementation for Primeo (PEO), an Ethereum token, does not check the numerical relationship between the amount of the air drop and the token's total supply, which lets the owner of the contract issue an arbitrary amount of currency. (Increasing the total supply by using 'doAirdrop' ignores the hard cap written in the contract and devalues the token.)"
    },
    {
        "function_name": "transferOwnership",
        "code": "function transferOwnership(address newOwner) onlyOwner public { if (newOwner != address(0)) { owner = newOwner; } }",
        "vulnerability": "Missing event emission on critical ownership change",
        "reason": "The transferOwnership function changes the ownership of the contract without emitting any event or logging the change. This omission makes ownership changes difficult to track and audit. A malicious owner can silently transfer ownership to another address without alerting users or auditors, potentially facilitating unnoticed malicious takeover or misuse of privileged functionalities.",
        "file_name": "2018-18425.sol",
        "label": "Token Devalue",
        "description": "The doAirdrop function of a smart contract implementation for Primeo (PEO), an Ethereum token, does not check the numerical relationship between the amount of the air drop and the token's total supply, which lets the owner of the contract issue an arbitrary amount of currency. (Increasing the total supply by using 'doAirdrop' ignores the hard cap written in the contract and devalues the token.)"
    },
    {
        "function_name": "approve",
        "code": "function approve(address _spender, uint256 _value) public returns (bool success) { if (_value != 0 && allowed[msg.sender][_spender] != 0) { return false; } allowed[msg.sender][_spender] = _value; emit Approval(msg.sender, _spender, _value); return true; }",
        "vulnerability": "Race condition vulnerability in approval (ERC20 approve race condition)",
        "reason": "The approve function implements a common ERC20 approval vulnerability. It allows approval only if setting to zero first to prevent race conditions. However, this is a non-standard and fragile workaround. If a user attempts to change allowance from one non-zero value to another directly, the transaction silently fails, requiring explicit zero-resetting. Attackers can exploit this race condition vulnerability by front-running approval transactions, causing token owners to mistakenly grant unintended allowances, potentially leading to unauthorized token spending or theft of tokens.",
        "file_name": "2018-18425.sol",
        "label": "Token Devalue",
        "description": "The doAirdrop function of a smart contract implementation for Primeo (PEO), an Ethereum token, does not check the numerical relationship between the amount of the air drop and the token's total supply, which lets the owner of the contract issue an arbitrary amount of currency. (Increasing the total supply by using 'doAirdrop' ignores the hard cap written in the contract and devalues the token.)"
    }
]